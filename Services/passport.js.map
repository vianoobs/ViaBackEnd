{"version":3,"file":"passport.js","sourceRoot":"","sources":["passport.ts"],"names":[],"mappings":"AAAA,MAAM,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AACrC,MAAM,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AACrC,MAAM,IAAI,GAAG,OAAO,CAAC,kBAAkB,CAAC,CAAC;AACzC,MAAM,cAAc,GAAG,OAAO,CAAC,yBAAyB,CAAC,CAAC,QAAQ,CAAC;AAEnE,oCAAoC;AACpC,MAAM,IAAI,GAAG,QAAQ,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;AAIrC,QAAQ,CAAC,GAAG,CAAC,IAAI,cAAc,CAAC;IAC5B,QAAQ,EAAE,IAAI,CAAC,cAAc;IAC7B,YAAY,EAAE,IAAI,CAAC,kBAAkB;IACrC,WAAW,EAAE,uBAAuB;IACpC,KAAK,EAAE,IAAI;CACd,EAAE,CAAC,WAAW,EAAE,YAAY,EAAE,OAAO,EAAE,IAAI,EAAE,EAAE;IAC5C,IAAI,CAAC,OAAO,CAAC,EAAC,QAAQ,EAAE,OAAO,CAAC,EAAE,EAAC,CAAC;SAC/B,IAAI,CAAC,IAAI,CAAC,EAAE;QACT,IAAI,IAAI,EAAE;YACN,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;SACpB;aAAM;YACH,IAAI,IAAI,CAAC;gBACL,QAAQ,EAAE,OAAO,CAAC,EAAE;gBACpB,SAAS,EAAE,OAAO,CAAC,IAAI,CAAC,SAAS;gBACjC,QAAQ,EAAE,OAAO,CAAC,IAAI,CAAC,UAAU;gBACjC,WAAW,EAAE,OAAO,CAAC,WAAW;aACnC,CAAC,CAAC,IAAI,EAAE;iBACJ,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;iBACpC,KAAK,CAAC,KAAK,CAAC,EAAE;gBACX,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAA;YACtB,CAAC,CAAC,CAAA;SACT;IACL,CAAC,CAAC;SACD,KAAK,CAAC,KAAK,CAAC,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAA;AAC3C,CAAC,CAAC,CAAC,CAAC","sourcesContent":["const passport = require('passport');\nconst mongoose = require('mongoose');\nconst keys = require('../Config/config');\nconst GoogleStrategy = require('passport-google-oauth20').Strategy;\n\n//access the users collection the db\nconst User = mongoose.model('users');\n\n\n\npassport.use(new GoogleStrategy({\n    clientID: keys.googleClientID,\n    clientSecret: keys.googleClientSecret,\n    callbackURL: '/auth/google/callback',\n    proxy: true\n}, (accessToken, refreshToken, profile, done) => {\n    User.findOne({googleId: profile.id})\n        .then(user => {\n            if (user) {\n                done(null, user);\n            } else {\n                new User({\n                    googleId: profile.id,\n                    firstName: profile.name.givenName,\n                    lastName: profile.name.familyName,\n                    displayName: profile.displayName\n                }).save()\n                    .then(newUser => done(null, newUser))\n                    .catch(error => {\n                        console.log(error)\n                    })\n            }\n        })\n        .catch(error => console.log(error))\n}));"]}