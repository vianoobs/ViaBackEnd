{"version":3,"file":"passport.js","sourceRoot":"","sources":["passport.ts"],"names":[],"mappings":"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","sourcesContent":["const passport = require('passport');\nconst mongoose = require('mongoose');\nconst keys = require('../config/config');\nconst GoogleStrategy = require('passport-google-oauth20').Strategy;\nconst FacebookStrategy = require('passport-facebook');\n\n//access the users collection the db\nconst User = mongoose.model('users');\n\npassport.serializeUser((user, done) => {\n    done(null, user);\n});\npassport.deserializeUser((id, done) => {\n    User.findById(id)\n        .then(user => {\n            done(null, user)\n        })\n        .catch(message => console.log(message))\n});\n\npassport.use(new GoogleStrategy({\n    clientID: keys.googleClientID,\n    clientSecret: keys.googleClientSecret,\n    callbackURL: '/auth/google/callback',\n    proxy: true\n}, (accessToken, refreshToken, profile, done) => {\n    console.log(profile);\n    User.findOne({userId: profile.id})\n        .then(user => {\n            if (user) {\n                done(null, user);\n            } else {\n                new User({\n                    userId: profile.id,\n                    firstName: profile.name.givenName,\n                    lastName: profile.name.familyName,\n                    displayName: profile.displayName\n                }).save()\n                    .then(newUser => done(null, newUser))\n                    .catch(error => {\n                        console.log(error)\n                    })\n            }\n        })\n        .catch(error => console.log(error))\n}));\n\npassport.use(new FacebookStrategy({\n        clientID: keys.facebookClientToken,\n        clientSecret: keys.facebookSecret,\n        callbackURL: \"http://localhost:8081/auth/facebook/callback\"\n    },\n    (accessToken, refreshToken, profile, done) => {\n        User.findOne({userId: profile.id})\n            .then(user => {\n                if (user) {\n                    done(null, user);\n                } else {\n                    new User({\n                        userId: profile.id,\n                        firstName: profile.name.givenName,\n                        lastName: profile.name.familyName,\n                        displayName: profile.displayName\n                    }).save()\n                        .then(newUser => done(null, newUser))\n                        .catch(error => {\n                            console.log(error)\n                        })\n                }\n            });\n    }\n));"]}